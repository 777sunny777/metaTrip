---
slug: storybook-usage
title: Storybook
authors: [sheldon]
tags: [storybook, react]
---

:::tip
- è¿™ç¯‡blogæ˜¯storybookçš„å…¥é—¨æ•™ç¨‹å¹¶ä¸”åŒ…å«äº†æˆ‘ä½¿ç”¨storybook 3å¹´å¤šçš„ä¸€äº›ä½“éªŒ 
- åªé’ˆå¯¹Reacté¡¹ç›®
- è¿›ä¸€æ­¥å­¦ä¹ ï¼Œè¯·è®¿é—®[Storybookå®˜ç½‘](https://storybook.js.org/)
:::

[Storybook](https://storybook.js.org/) is an open source tool for building UI components and pages in isolation. It streamlines UI development, testing, and documentation.

ä»Storybookçš„å®˜æ–¹æè¿°æ¥çœ‹ï¼Œä»–æ˜¯ç”¨äºå¿«é€Ÿæ„å»ºUI demoçš„å·¥å…·ï¼Œå¯ä»¥å¸®ç”¨æˆ·å¿«é€Ÿæ„å»ºé¡µé¢ï¼›å¹¶ä¸”æœ‰å¾ˆå¥½çš„è¯­æ³•åŠŸèƒ½ï¼Œè½»æ¾ä¹¦å†™demoï¼›è¿˜æœ‰å¾ˆå¥½çš„è¾…åŠ©æ’ä»¶ï¼Œ
æ¯”å¦‚demoçš„æ–‡æ¡£è¾…åŠ©ï¼Œå‚æ•°è¾…åŠ©ï¼Œè¿˜æœ‰accessibilityè¾…åŠ©æµ‹è¯•ç­‰ç­‰ã€‚è¿™ä¸€åˆ‡å‡ ä¹ä¿ƒä½¿å®ƒæˆä¸ºäº†é¡¹ç›®demoçš„æœ€å¥½é€‰æ‹©ã€‚å› ä¸ºæˆ‘çš„é¡¹ç›®æ¶‰åŠåˆ°ç»„ä»¶åº“çš„å¼€å‘ï¼Œ
æ‰€ä»¥storybookå°±æ›´æ˜¾å¾—åˆé€‚å’Œé‡è¦ã€‚

:::note
- version: v6.4.9(Currently) and [Latest](https://github.com/storybookjs/storybook/releases)
:::

Storybook ä»£ç åº“æ›´æ–°å¾ˆæ´»è·ƒï¼Œå‡ ä¹ä¸€å¹´ä¸€æ¬¡majorç‰ˆæœ¬çš„æ›´æ–°ï¼Œæ€»ä¼šå¸¦æ¥äº›æ–°çš„åŠŸèƒ½ï¼Œè¿™ç¯‡blogæˆ‘ä»¬é‚£ç›®å‰æœ€æ–°ç‰ˆæœ¬v6.4.9 ä¸ºä¾‹è¿›è¡Œè¯´æ˜

## 1. å®‰è£…

Storybook çš„[å®‰è£…](https://storybook.js.org/docs/react/get-started/install)å¾ˆæ™ºèƒ½ï¼Œnpx sb init å°±å¯ä»¥ç›´æ¥è¿›è¡Œå®‰è£…ï¼Œä½†æ˜¯è¦æ³¨æ„çš„æ˜¯å®‰è£…ä¹‹å‰ä½ å¿…é¡»å·²ç»æœ‰é¡¹ç›®æ¡†æ¶çš„ä¾èµ–ã€‚

:::note
- Storybook will look into your project's dependencies during its install process and provide you with the best configuration available.
- Storybookåªæ˜¯éœ€è¦é¡¹ç›®æ¡†æ¶ä¾èµ–ï¼Œæ¯”å¦‚reactå°±ç›¸å½“äºä¸€ä¸ªæ ‡è¯†ï¼Œä½ ä¸éœ€è¦å†™ä»»ä½•æ¡†æ¶ä»£ç åœ¨é¡¹ç›®ä¸­
:::


## 2. Write stories

Storyå°±æ˜¯ä¸€ä¸ªdemo caseï¼Œstories fileå°±æ˜¯å­˜æ”¾ä¸€ç±»demo casesçš„é›†åˆï¼Œè¿™äº›casesæ ¹æ®titleåˆ†æˆä¸åŒçš„ç±»å‹

```jsx
// è¿™ä¸ªä¸€ä¸ªå±•ç¤ºbuttonçš„stories file
// Button.stories.js|jsx

import React from 'react';

import { Button } from './Button';

export default {
  
  // titleæ˜¯è¿™ä¸ªé›†åˆçš„åç§°ï¼ŒåŒæ—¶ä¹Ÿç”¨äºstorybook å¯¼èˆªæ çš„ç»“æ„
  // æ¯”å¦‚å¯ä»¥æœ‰å±‚çº§å…³ç³»ï¼Œ'Button/Responsive'

  title: 'Button',
  
  // component å±æ€§å¯ä»¥ä¸å†™, åé¢è§£é‡Šæ–‡æ¡£çš„æ—¶å€™å†è¯¦ç»†è¯´
  // Storybook uses the component key in the story fileâ€™s default export to extract the component's description and props.
  
  component: Button,
};

// è¿™é‡Œé€šè¿‡exportå¯¼å‡ºå°±ç”Ÿæˆäº†ä¸€ä¸ªdemo case page
// è·¯å¾„å°±æ˜¯å·¦ä¾§å¯¼èˆªæ ä¸­ Buttonä¸‹é¢çš„Primary

export const Primary = () => <Button primary>Button</Button>;

// è¿™é‡Œå¯ä»¥æ”¹å˜caseçš„å‘½åï¼Œé»˜è®¤æ˜¯function name
Primary.storyName = 'I am the primary';

export const Secondary = () => <Button backgroundColor="#ff0" label="ğŸ˜„ğŸ‘ğŸ˜ğŸ’¯" />;
export const Tertiary = () => <Button backgroundColor="#ff0" label="ğŸ“šğŸ“•ğŸ“ˆğŸ¤“" />;

```

### 2-1 Using args

ä½¿ç”¨argsæ˜¯æœ€æ–°ç‰ˆæœ¬ä¸­storybook æ¯”è¾ƒå»ºè®®çš„å†™æ³•ï¼Œä¸»è¦çš„ä¼˜ç‚¹æ˜¯å‡å°‘é‡å¤ä»£ç ï¼Œç”¨æ³•ä¸Šä¹Ÿæ¯”è¾ƒæœ‰ç« å¯å¾ªï¼Œä¾¿äºç®¡ç†ã€‚
ä¸è¿‡æ ¹æ®æˆ‘çš„ç»éªŒè¿˜æ˜¯è¦çœ‹ä½ ç”¨storybookçš„targetæ˜¯ä»€ä¹ˆï¼Œå¦‚æœåªæ˜¯for show UI demoï¼Œä½¿ç”¨args çš„æ–¹å¼æ˜¯å¯è¡Œçš„ã€‚
ä½†æ˜¯æ¯”å¦‚åšç»„ä»¶åº“ï¼Œshow UI demoåªæ˜¯ä¸€ä¸ªæ–¹é¢ï¼Œshow demo code for users ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡storybookçš„caseså¯ä»¥è®©ç”¨æˆ·
ç›´è§‚çš„æ˜ç™½demo è¦æ€ä¹ˆå†™ï¼Œç”šè‡³åªéœ€è¦ä»–copy/pasteå°±å¯ä»¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±éœ€è¦å°½é‡å°‘çš„ä½¿ç”¨storybookæä¾›çš„ä¸€äº›æ¥å£æ–¹æ³•ï¼Œå‡å°‘storybook
å¯¹ä½ çš„demo case code çš„å¹²æ‰°ã€‚

ä»»ä½•æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½è¦æ˜ç™½ç”¨æˆ·å…³å¿ƒçš„æ˜¯ä»€ä¹ˆï¼Ÿè€Œä¸æ˜¯ç›²ç›®çš„æ±‚æ–°æ±‚å˜ã€‚

```jsx
import React from 'react';
import { Button } from './Button';

export default {
  title: 'Button',
  component: Button,
};

//ğŸ‘‡ We create a â€œtemplateâ€ of how args map to rendering
const Template = (args) => <Button {...args} />;

// ğŸ‘‡ Each story then reuses that template
export const Primary = Template.bind({});
Primary.args = { background: '#ff0', label: 'Button' };

export const Secondary = Template.bind({});
Secondary.args = { ...Primary.args, label: 'ğŸ˜„ğŸ‘ğŸ˜ğŸ’¯' };

export const Tertiary = Template.bind({});
Tertiary.args = { ...Primary.args, label: 'ğŸ“šğŸ“•ğŸ“ˆğŸ¤“' };
```

### 2-2 Remix two stories

Storyæ˜¯å¯ä»¥ç›¸äº’å¼•ç”¨çš„ï¼Œä¸»è¦ä¹Ÿæ˜¯ä¸ºäº†å‡å°‘é‡å¤ä»£ç ï¼Œä¿æŒä¸€è‡´æ€§ã€‚

```jsx
import React from 'react';
import { Button } from './Button';
import * as TextInputStories from './TextInput.stories';

export default {
  title: 'Button',
  component: Button,
};

export const TestRemix = () => <>
  <TextInputStories.Default />
  <Button primary>Button</Button>
<>

```


### 2-3 Controls

é¦–å…ˆControlæ˜¯å¾ˆå¥½çš„åŠŸèƒ½ï¼Œå¯¹äºshow UI demo æ˜¯å¾ˆæ–¹ä¾¿ç›´è§‚çš„å±•ç¤ºï¼Œå¯¹äºV6ç‰ˆæœ¬ï¼ŒControl æ˜¯å†…ç½®æ’ä»¶ï¼Œåªéœ€è¦é€šè¿‡Templateå’Œargsé…åˆå°±å¯ä»¥è‡ªåŠ¨ç”Ÿæˆ

[è¯¦ç»†å†™æ³•](https://storybook.js.org/docs/react/essentials/controls)

åœ¨ä½ç‰ˆæœ¬ä¸­(V6ä»ç„¶æ”¯æŒaddonså†™æ³•)ï¼Œæ˜¯é€šè¿‡å®‰è£…addon-knobsæ’ä»¶æ¥å®ç°çš„ã€‚ 

<video autoplay="" muted="" playsinline="" loop="">
    <source src="https://storybook.js.org/9d2e1f29cfb010e3aae6cd76547c4bab/addon-controls-optimized.mp4" type="video/mp4">
</video>

æ ¹æ®æˆ‘çš„ç»éªŒï¼Œå’Œusing args ä¸€æ ·ï¼Œä½¿ç”¨è¿˜æ˜¯ä¸ä½¿ç”¨éœ€è¦æ ¹æ®é¡¹ç›®éœ€æ±‚ï¼Œæˆ–è€…å¯»æ‰¾æŠ˜ä¸­çš„æ–¹æ³•è€Œä¸¤è€…å…¼é¡¾ã€‚


### 2-4 Action

æˆ‘ç›®å‰è¿˜æ²¡æœ‰æ‰¾åˆ°Actionçš„åˆé€‚åœºæ™¯ã€‚å®ƒå’ŒControlä¸€æ ·çš„ï¼Œåœ¨V6ç‰ˆæœ¬ä¸­æ˜¯å†…ç½®æ’ä»¶ï¼Œéœ€è¦argTypesæ¥å®šä¹‰ï¼Œæ–°ç‰ˆæœ¬ä¸­éœ€è¦å†™æˆtemplateå½¢å¼æ‰èƒ½è§¦å‘ã€‚

<video autoplay="" muted="" playsinline="" loop="">
    <source src="https://storybook.js.org/b0366940cf7195b6d5b646c6105c217c/addon-actions-optimized.mp4" type="video/mp4">
</video>

```jsx
import { Button } from './Button';

export default {
  title: 'Button',
  component: Button,
  argTypes: { onClick: { action: 'clicked' } },
};

```

```jsx
// .storybook/preview.js

export const parameters = {
  actions: { argTypesRegex: '^on.*' }
}

```

