"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[795],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return h}});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=o.createContext({}),d=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},c=function(e){var t=d(e.components);return o.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},p=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=d(n),h=a,u=p["".concat(l,".").concat(h)]||p[h]||m[h]||i;return n?o.createElement(u,r(r({ref:t},c),{},{components:n})):o.createElement(u,r({ref:t},c))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,r=new Array(i);r[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,r[1]=s;for(var d=2;d<i;d++)r[d]=n[d];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}p.displayName="MDXCreateElement"},1676:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return l},default:function(){return h},frontMatter:function(){return s},metadata:function(){return d},toc:function(){return m}});var o=n(7462),a=n(3366),i=(n(7294),n(3905)),r=["components"],s={slug:"microFE1",title:"Micro FrontEnd Basic",authors:["sheldon"],tags:["micro","react","javaScript"]},l=void 0,d={permalink:"/metaTrip/build/blog/microFE1",source:"@site/blog/2022-01-26-microFE1.mdx",title:"Micro FrontEnd Basic",description:"- \u8fd9\u662f\u6211\u5bf9\u4e8eMFE\u6bd4\u8f83\u7cfb\u7edf\u5b66\u4e60\u8bb0\u5f55\u7684\u9996\u7bc7blog",date:"2022-01-26T00:00:00.000Z",formattedDate:"January 26, 2022",tags:[{label:"micro",permalink:"/metaTrip/build/blog/tags/micro"},{label:"react",permalink:"/metaTrip/build/blog/tags/react"},{label:"javaScript",permalink:"/metaTrip/build/blog/tags/java-script"}],readingTime:14.44,truncated:!0,authors:[{name:"Sheldon Y Sun",title:"Jser @ Open Source Community",url:"https://github.com/777sunny777",imageURL:"https://github.com/777sunny777.png",key:"sheldon"}],prevItem:{title:"useEffect\uff0cyou really know it?",permalink:"/metaTrip/build/blog/react1"},nextItem:{title:"\u5e38\u89c1\u884c\u4e1a\u6307\u6570\u57fa\u91d1",permalink:"/metaTrip/build/blog/funding-basic4"}},c={authorsImageUrls:[void 0]},m=[{value:"1. Micro Frontends",id:"1-micro-frontends",children:[{value:"1-1. MFE cost",id:"1-1-mfe-cost",children:[],level:3}],level:2},{value:"2. Benefits",id:"2-benefits",children:[{value:"2-1. Incremental upgrades(\u589e\u91cf\u5347\u7ea7)",id:"2-1-incremental-upgrades\u589e\u91cf\u5347\u7ea7",children:[],level:3},{value:"2-2. Simple, decoupled codebases(\u7b80\u5355\uff0c\u89e3\u8026)",id:"2-2-simple-decoupled-codebases\u7b80\u5355\u89e3\u8026",children:[],level:3},{value:"2-3. Independent deployment(\u72ec\u7acb\u90e8\u7f72)",id:"2-3-independent-deployment\u72ec\u7acb\u90e8\u7f72",children:[],level:3},{value:"2-4. Autonomous teams(\u81ea\u6cbb\u56e2\u961f)",id:"2-4-autonomous-teams\u81ea\u6cbb\u56e2\u961f",children:[],level:3}],level:2},{value:"3. Integration approaches",id:"3-integration-approaches",children:[{value:"3-1. Server-side template composition",id:"3-1-server-side-template-composition",children:[],level:3},{value:"3-2. Build-time integration",id:"3-2-build-time-integration",children:[],level:3},{value:"3-3. Run-time integration via iframes",id:"3-3-run-time-integration-via-iframes",children:[],level:3},{value:"3-4. Run-time integration via JavaScript(\u4e3b\u8981\u5b9e\u73b0\u65b9\u5f0f)",id:"3-4-run-time-integration-via-javascript\u4e3b\u8981\u5b9e\u73b0\u65b9\u5f0f",children:[],level:3},{value:"3-5. Run-time integration via Web Components",id:"3-5-run-time-integration-via-web-components",children:[],level:3}],level:2},{value:"4. Styling",id:"4-styling",children:[],level:2},{value:"5. Shared component libraries",id:"5-shared-component-libraries",children:[],level:2},{value:"6. Cross-application communication",id:"6-cross-application-communication",children:[],level:2}],p={toc:m};function h(e){var t=e.components,n=(0,a.Z)(e,r);return(0,i.kt)("wrapper",(0,o.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("ul",{parentName:"div"},(0,i.kt)("li",{parentName:"ul"},"\u8fd9\u662f\u6211\u5bf9\u4e8eMFE\u6bd4\u8f83\u7cfb\u7edf\u5b66\u4e60\u8bb0\u5f55\u7684\u9996\u7bc7blog "),(0,i.kt)("li",{parentName:"ul"},"\u4e3b\u8981\u53c2\u8003\u7684Cam Jackson\u7684\u6587\u7ae0",(0,i.kt)("a",{parentName:"li",href:"https://martinfowler.com/articles/micro-frontends.html"},"Micro Frontends"))))),(0,i.kt)("p",null,"Cam Jackson \u662fThoughtworks\u7684\u5168\u6808\u5de5\u7a0b\u5e08\uff0c\u8fd9\u7bc7\u6587\u7ae0\u867d\u7136\u51fa\u81ea2019\u5e74\uff0c\u4f46\u662f\u5bf9\u4e8eMFE\u6982\u5ff5\u7684\u521d\u5b66\u8005\u8fd8\u662f\u53cb\u597d\u7684\uff0c\u53ef\u4ee5\u6bd4\u8f83\u5bb9\u6613\u7684\u7406\u89e3\u3002\n\u76f8\u5e94\u7684\u6587\u7ae0\u6700\u540e\u8fd8\u63d0\u4f9b\u4e86MEF\u7684example, \u6309\u7167\u6587\u7ae0\u987a\u5e8f\u53bb\u5b66\u4e60\uff0c\u5e94\u8be5\u53ef\u4ee5\u5f88\u5feb\u5165\u95e8\u3002\u6211\u7684\u8fd9\u7bc7blog\uff0c\u7b97\u662f\u5bf9\u4ed6\u7684\u6587\u7ae0\u548c\u6211\u4e00\u70b9\u7ecf\u9a8c\u7684\u603b\u7ed3\uff0c\n\u6211\u4eec\u76f4\u63a5\u6b65\u5165\u6b63\u9898\u3002"),(0,i.kt)("h2",{id:"1-micro-frontends"},"1. Micro Frontends"),(0,i.kt)("p",null,'"An architectural style where independently deliverable frontend applications are composed into a greater whole"'),(0,i.kt)("p",null,"\u8fd9\u662fCam Jackson \u6216\u8005\u8bf4\u662fThoughtworks\u5bf9MFE\u7684\u5b9a\u4e49\u3002\u6211\u4eec\u4ece\u4e2d\u53ef\u4ee5\u63d0\u53d6\u5230\u4e24\u4e2a\u91cd\u70b9\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"independently deliverable. \u72ec\u7acb\u4ea4\u4ed8"),(0,i.kt)("li",{parentName:"ul"},"composed into a greater whole. \u7ec4\u5408\u6784\u6210\u6574\u4f53")),(0,i.kt)("h3",{id:"1-1-mfe-cost"},"1-1. MFE cost"),(0,i.kt)("p",null,"\u56e0\u4e3a\u540e\u9762\u6211\u4eec\u8981\u8be6\u7ec6\u89e3\u8bfb\u4e0bMFE\u7684Benefits\uff0c\u6240\u4ee5\u8fd9\u91cc\u4e3b\u8981\u662f\u5148\u5c06\u4e00\u4e0b\u4ed6\u7684cost\uff1a"),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"there are no free lunches when it comes to software architecture - everything comes with a cost."),(0,i.kt)("ul",{parentName:"div"},(0,i.kt)("li",{parentName:"ul"},"Some micro frontend implementations can lead to duplication of dependencies"),(0,i.kt)("li",{parentName:"ul"},"increasing the number of bytes our users must download"),(0,i.kt)("li",{parentName:"ul"},"the dramatic increase in team autonomy can cause fragmentation in the way your teams work")),(0,i.kt)("p",{parentName:"div"},"Nonetheless, we believe that these risks can be managed, and that the benefits of micro frontends often outweigh the costs"))),(0,i.kt)("p",null,"\u603b\u4f53\u6765\u8bf4\uff0cMFE\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4f9d\u8d56\u91cd\u590d\uff0c\u589e\u52a0\u4e86\u9700\u8981download\u7684asset\uff0c\u8fd8\u6709\u5c31\u662f\u72ec\u7acb\u56e2\u961f\u5de5\u4f5c\u65b9\u5f0f\u4e0a\u7684\u4e00\u4e9b\u6311\u6218\u3002\u5bf9\u4e8e\u7ed3\u8bbaThoughtworks\u8ba4\u4e3a\u603b\u4f53\u4e0aMFE\u8fd8\u662f\u5229\u5927\u4e8e\u5f0a\u7684\u3002\n\u6211\u4eec\u63a5\u4e0b\u6765\u8bf4\u8bf4Benefits\u3002"),(0,i.kt)("h2",{id:"2-benefits"},"2. Benefits"),(0,i.kt)("h3",{id:"2-1-incremental-upgrades\u589e\u91cf\u5347\u7ea7"},"2-1. Incremental upgrades(\u589e\u91cf\u5347\u7ea7)"),(0,i.kt)("p",null,"The endgame here is that we're afforded more freedom to make case-by-case decisions on individual parts of our product,\nand to make incremental upgrades to our architecture, our dependencies, and our user experience.\nIf there is a major breaking change in our main framework, each micro frontend can be upgraded whenever it makes sense,\nrather than being forced to stop the world and upgrade everything at once. If we want to experiment with new technology,\nor new modes of interaction, we can do it in a more isolated fashion than we could before."),(0,i.kt)("p",null,"\u597d\u5904\u4e4b\u4e00\u5c31\u662fMFE\u7684\u5b50\u6a21\u5757\u5347\u7ea7\u662f\u81ea\u4e3b\u7684\uff0c\u5e76\u4e14\u4e0e\u4e3b\u6a21\u5757\u89e3\u8026\uff0c\u5373\u4e3b\u6a21\u5757\u6709\u8fc7\u6709\u4e9b\u5927\u7684major breaking changes\uff0c\u5b50\u6a21\u5757\u4e5f\u4e0d\u9700\u8981\u548c\u4e3b\u6a21\u5757\u540c\u6b65\u8fdb\u884c\u4fee\u6539\u548c\u5347\u7ea7\u3002\n\u800c\u662f\u53ef\u4ee5\u9009\u62e9\u4e00\u4e2a\u81ea\u8eab\u5408\u9002\u7684\u65f6\u673a\u6765\u8fdb\u884c\u5347\u7ea7\u3002"),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"\u8fd9\u91cc\u9762\u6211\u7684\u7406\u89e3\u662f\uff1a\u4e3b\u6a21\u5757\u7684\u4ee5\u6765\u8fd8\u662f\u4f1adefault\u5f71\u54cdMFE\u7684\u5b50\u6a21\u5757\u7684\uff0c\u4f46\u662f\u5b50\u6a21\u5757\u81ea\u8eab\u53ef\u4ee5\u9009\u62e9\u8981\u4e0d\u8981\u8fd9\u79cd\u5f71\u54cd\uff0c\u5373\u4f9d\u8d56\u4e3b\u6a21\u5757\u7684\u4f9d\u8d56\uff0c\n\u6216\u8005\u5173\u95ed\u4e3b\u6a21\u5757\u4f9d\u8d56\u800c\u53ea\u9009\u62e9\u81ea\u8eab\u7684\u4f9d\u8d56\uff0c\u8fd9\u6837\u5c31\u6bd4\u8f83\u7075\u6d3b\u548c\u81ea\u4e3b\u4e86\u3002\u8fd9\u6761\u6211\u4f1a\u5728\u540e\u9762\u8fdb\u884c\u76f8\u5e94\u7684\u5370\u8bc1\u3002"))),(0,i.kt)("h3",{id:"2-2-simple-decoupled-codebases\u7b80\u5355\u89e3\u8026"},"2-2. Simple, decoupled codebases(\u7b80\u5355\uff0c\u89e3\u8026)"),(0,i.kt)("p",null,"These smaller codebases tend to be simpler and easier for developers to work with.\nIn particular, we avoid the complexity arising from unintentional and inappropriate coupling between components\nthat should not know about each other. "),(0,i.kt)("p",null,"micro frontends push you to be explicit and deliberate about how data and events flow\nbetween different parts of the application, which is something that we should have been doing anyway!"),(0,i.kt)("p",null,"MFE\u4e00\u5b9a\u662f\u5c0f\u800c\u7cbe\u7684\uff0c\u5c3d\u91cf\u51cf\u5c11\u7ec4\u4ef6\u95f4\u6570\u636e\u6216\u4e8b\u4ef6\u4f20\u8f93\uff0c\u8fd9\u4e00\u70b9\u9700\u8981\u6211\u4eec\u6df1\u5165\u7684\u601d\u8003\u3002"),(0,i.kt)("h3",{id:"2-3-independent-deployment\u72ec\u7acb\u90e8\u7f72"},"2-3. Independent deployment(\u72ec\u7acb\u90e8\u7f72)"),(0,i.kt)("p",null,"Just as with microservices, independent deployability of micro frontends is key.\nThis reduces the scope of any given deployment, which in turn reduces the associated risk.\nRegardless of how or where your frontend code is hosted, each micro frontend should have\nits own continuous delivery pipeline, which builds, tests and deploys it all the way to production.\nWe should be able to deploy each micro frontend with very little thought given to the current state of\nother codebases or pipelines. It shouldn't matter if the old monolith is on a fixed, manual,\nquarterly release cycle, or if the team next door has pushed a half-finished or broken feature into their master branch.\nIf a given micro frontend is ready to go to production, it should be able to do so, and that decision\nshould be up to the team who build and maintain it."),(0,i.kt)("p",null,"MFE\u662f\u9700\u8981\u5bf9\u7acb\u8fdb\u884cbuild\uff0ctest\u548cdeploy\u5230production\u7684\uff0c\u8fd9\u4e2a\u4e5f\u662f\u5176\u4e3b\u8981\u7279\u5f81\u4e4b\u4e00\uff0c\u4e5f\u662f\u4e00\u822c\u9879\u76ee\u8fdb\u884cMFE\u67b6\u6784\u91cd\u6784\u7684\u4e3b\u8981\u76ee\u7684\u3002"),(0,i.kt)("img",{src:"/metaTrip/build/img/blog/deployment.png",alt:"",style:{width:"100%"}}),(0,i.kt)("h3",{id:"2-4-autonomous-teams\u81ea\u6cbb\u56e2\u961f"},"2-4. Autonomous teams(\u81ea\u6cbb\u56e2\u961f)"),(0,i.kt)("p",null,"Teams can have full ownership of everything they need to deliver value to customers,\nwhich enables them to move quickly and effectively"),(0,i.kt)("p",null,"\u4f9d\u8d56\u8d8a\u5c11\uff0c\u54cd\u5e94\u8d8a\u7075\u6d3b\u3002\u8fd9\u4e2a\u548c\u7b2c\u4e09\u6761\u6bd4\u8f83\u76f8\u8f85\u76f8\u6210\u3002"),(0,i.kt)("img",{src:"/metaTrip/build/img/blog/horizontal.png",alt:"",style:{width:"100%"}}),(0,i.kt)("h2",{id:"3-integration-approaches"},"3. Integration approaches"),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"}," there is a micro frontend for each page in the application, and there is a single container application, which:"),(0,i.kt)("ul",{parentName:"div"},(0,i.kt)("li",{parentName:"ul"},"renders common page elements such as headers and footers"),(0,i.kt)("li",{parentName:"ul"},"addresses cross-cutting concerns like authentication and navigation"),(0,i.kt)("li",{parentName:"ul"},"brings the various micro frontends together onto the page, and tells each micro frontend when and where to render itself")))),(0,i.kt)("img",{src:"/metaTrip/build/img/blog/composition.png",alt:"",style:{width:"100%"}}),(0,i.kt)("h3",{id:"3-1-server-side-template-composition"},"3-1. Server-side template composition"),(0,i.kt)("p",null,"rendering HTML on the server out of multiple templates or fragments.\nWe have an index.html which contains any common page elements,\nand then uses server-side includes to plug in page-specific content from fragment HTML files"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},'<html lang="en" dir="ltr">\n  <head>\n    <meta charset="utf-8">\n    <title>Feed me</title>\n  </head>\n  <body>\n    <h1>\ud83c\udf7d Feed me</h1>\n    \x3c!--# include file="$PAGE.html" --\x3e\n  </body>\n</html>\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"server {\n    listen 8080;\n    server_name localhost;\n\n    root /usr/share/nginx/html;\n    index index.html;\n    ssi on;\n\n    # Redirect / to /browse\n    rewrite ^/$ http://localhost:8080/browse redirect;\n\n    # Decide which HTML fragment to insert based on the URL\n    location /browse {\n      set $PAGE 'browse';\n    }\n    location /order {\n      set $PAGE 'order';\n    }\n    location /profile {\n      set $PAGE 'profile'\n    }\n\n    # All locations should render through index.html\n    error_page 404 /index.html;\n}\n")),(0,i.kt)("p",null,"This example shows how micro frontends is not necessarily a new technique,\nand does not have to be complicated.\nAs long as we're careful about how our design decisions affect the autonomy of our codebases and our teams, we can achieve many of the same benefits regardless of our tech stack."),(0,i.kt)("p",null,"\u5b9e\u9645\u4e0a\u8fd9\u4e2a\u4f8b\u5b50\u53ea\u662f\u8981\u544a\u8bc9\u6211\u4eec\uff0cMFE\u662f\u4e00\u79cd\u601d\u60f3\uff0c\u5e76\u4e0d\u662f\u4e00\u4e2a\u65b0\u7684\u6280\u672f\uff0c\u6216\u8005\u9700\u8981\u65b0\u7684\u6280\u672f\u624d\u53ef\u4ee5\u5b9e\u73b0\u3002\n\u53ea\u8981\u6ee1\u8db3\u72ec\u7acb\u4ea4\u4ed8\uff0c\u7ec4\u5408\u6784\u6210\u6574\u4f53\u90fd\u5e94\u8be5\u662fMFE\u7684\u8303\u7574\u3002"),(0,i.kt)("h3",{id:"3-2-build-time-integration"},"3-2. Build-time integration"),(0,i.kt)("p",null,"One approach that we sometimes see is to publish each micro frontend as a package,\nand have the container application include them all as library dependencies.\nHere is how the container's package.json might look for our example app:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},'{\n  "name": "@feed-me/container",\n  "version": "1.0.0",\n  "description": "A food delivery web app",\n  "dependencies": {\n    "@feed-me/browse-restaurants": "^1.2.3",\n    "@feed-me/order-food": "^4.5.6",\n    "@feed-me/user-profile": "^7.8.9"\n  }\n}\n')),(0,i.kt)("p",null,"component ui library \u6846\u67b6\u5c31\u662f\u4e00\u79cdbuild-time\u7684\u6a21\u5f0f\u3002\u4ed6\u7684\u5f15\u7528\u662f\u57fa\u4e8epackage\u7684\uff0c\u4f9d\u8d56\u7684\u5f62\u5f0f\u5b58\u5728\u3002\n\u5f88\u591a\u5927\u7684\u9879\u76ee\u4e5f\u662f\u8fd9\u79cd\u5047\u7684MFE\u5f00\u53d1\u65b9\u5f0f\u3002"),(0,i.kt)("p",null,"At first this seems to make sense. It produces a single deployable Javascript bundle,\nas is usual, allowing us to de-duplicate common dependencies from our various applications.\nHowever, this approach means that we have to re-compile and release every single micro frontend\nin order to release a change to any individual part of the product. Just as with microservices,\nwe've seen enough pain caused by such a lockstep release process that we would recommend\nstrongly against this kind of approach to micro frontends."),(0,i.kt)("p",null,"\u8fd9\u79cd\u65b9\u5f0f\u7684\u4e0d\u5408\u7406\u4e4b\u5904\u5c31\u5728\u4e8ecompile\u548crelease\u90fd\u9700\u8981\u540c\u6b65\u8fdb\u884c\uff0c\u8fd9\u4e2a\u548cMFE\u72ec\u7acb\u4ea4\u4ed8\u7684\u6982\u5ff5\u662f\u7edd\u5bf9\u76f8\u53cd\u7684\uff0c\u662f\u53cdMFE\u7684\u4e00\u79cd\u65b9\u5f0f\u3002\nWe should find a way to integrate our micro frontends at run-time, rather than at build-time."),(0,i.kt)("h3",{id:"3-3-run-time-integration-via-iframes"},"3-3. Run-time integration via iframes"),(0,i.kt)("p",null,"One of the simplest approaches to composing applications together in the browser is the humble iframe.\nBy their nature, iframes make it easy to build a page out of independent sub-pages.\nThey also offer a good degree of isolation in terms of styling and global variables not interfering with each other."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"<html>\n  <head>\n    <title>Feed me!</title>\n  </head>\n  <body>\n    <h1>Welcome to Feed me!</h1>\n\n    <iframe id=\"micro-frontend-container\"></iframe>\n\n    <script type=\"text/javascript\">\n      const microFrontendsByRoute = {\n        '/': 'https://browse.example.com/index.html',\n        '/order-food': 'https://order.example.com/index.html',\n        '/user-profile': 'https://profile.example.com/index.html',\n      };\n\n      const iframe = document.getElementById('micro-frontend-container');\n      iframe.src = microFrontendsByRoute[window.location.pathname];\n    <\/script>\n  </body>\n</html>\n")),(0,i.kt)("p",null,"It can be difficult to build integrations between different parts of the application,\nso they make routing, history, and deep-linking more complicated,\nand they present some extra challenges to making your page fully responsive."),(0,i.kt)("p",null,"iframes\u89c9\u5f97\u662fMFE\u6700\u7b80\u5355\u7684\u5b9e\u73b0\u65b9\u5f0f\uff0c\u6211\u4eec\u4e3b\u8981\u8003\u8651\u5230\u7075\u6d3b\u6027\u7684\u4e00\u4e9b\u95ee\u9898\u800c\u4e0d\u53bb\u91c7\u7528\u5b83\u3002\u6bd4\u5982responsive\u7684\u5b9e\u73b0\u5c31\u5f88\u56f0\u96be\u3002"),(0,i.kt)("h3",{id:"3-4-run-time-integration-via-javascript\u4e3b\u8981\u5b9e\u73b0\u65b9\u5f0f"},"3-4. Run-time integration via JavaScript(\u4e3b\u8981\u5b9e\u73b0\u65b9\u5f0f)"),(0,i.kt)("p",null,"probably the most flexible one, and the one that we see teams adopting most frequently.\nEach micro frontend is included onto the page using a ",(0,i.kt)("strong",{parentName:"p"},"script")," tag, and upon load exposes a global function as its entry-point.\nThe container application then determines which micro frontend should be mounted,\nand calls the relevant function to tell a micro frontend when and where to render itself."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},'<html>\n  <head>\n    <title>Feed me!</title>\n  </head>\n  <body>\n    <h1>Welcome to Feed me!</h1>\n\n    \x3c!-- These scripts don\'t render anything immediately --\x3e\n    \x3c!-- Instead they attach entry-point functions to `window` --\x3e\n    <script src="https://browse.example.com/bundle.js"><\/script>\n    <script src="https://order.example.com/bundle.js"><\/script>\n    <script src="https://profile.example.com/bundle.js"><\/script>\n\n    <div id="micro-frontend-root"></div>\n\n    <script type="text/javascript">\n      // These global functions are attached to window by the above scripts\n      const microFrontendsByRoute = {\n        \'/\': window.renderBrowseRestaurants,\n        \'/order-food\': window.renderOrderFood,\n        \'/user-profile\': window.renderUserProfile,\n      };\n      const renderFunction = microFrontendsByRoute[window.location.pathname];\n\n      // Having determined the entry-point function, we now call it,\n      // giving it the ID of the element where it should render itself\n      renderFunction(\'micro-frontend-root\');\n    <\/script>\n  </body>\n</html>\n')),(0,i.kt)("p",null,"The above is obviously a primitive example, but it demonstrates the basic technique.\nUnlike with build-time integration, we can deploy each of the bundle.js files independently.\nAnd unlike with iframes, we have full flexibility to build integrations between our micro frontends however we like.\nWe could extend the above code in many ways, for example to only download each JavaScript bundle as needed,\nor to pass data in and out when rendering a micro frontend.The flexibility of this approach, combined with the independent\ndeployability, makes it our default choice, and the one that we've seen in the wild most often."),(0,i.kt)("p",null,"\u8fd9\u79cd\u65b9\u5f0f\u4e0eiframe\u76f8\u6bd4\uff0c\u53ef\u4ee5\u89e3\u51b3\u5b50\u6a21\u5757\u95f4\u7684\u540c\u6b65\u534f\u4f5c\u95ee\u9898\uff0c\u6bd4\u5982responsive\u3002\u4e0ebuild-time\u76f8\u6bd4\uff0c\u53ef\u4ee5\u72ec\u7acb\u4ea4\u4ed8\u3002\u800c\u4e14\u8fd8\u53ef\u4ee5\u6309\u9700\u52a0\u8f7d\u3002\n\u6240\u4ee5\u6210\u4e3a\u4e86MFE\u5b9e\u73b0\u7684\u6700\u4e3b\u8981\u65b9\u5f0f\u3002"),(0,i.kt)("h3",{id:"3-5-run-time-integration-via-web-components"},"3-5. Run-time integration via Web Components"),(0,i.kt)("p",null," for each micro frontend to define an HTML custom element for the container to instantiate,\ninstead of defining a global function for the container to call."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},"<html>\n <head>\n   <title>Feed me!</title>\n </head>\n <body>\n   <h1>Welcome to Feed me!</h1>\n\n   \x3c!-- These scripts don't render anything immediately --\x3e\n   \x3c!-- Instead they each define a custom element type --\x3e\n   <script src=\"https://browse.example.com/bundle.js\"><\/script>\n   <script src=\"https://order.example.com/bundle.js\"><\/script>\n   <script src=\"https://profile.example.com/bundle.js\"><\/script>\n\n   <div id=\"micro-frontend-root\"></div>\n\n   <script type=\"text/javascript\">\n     // These element types are defined by the above scripts\n     const webComponentsByRoute = {\n       '/': 'micro-frontend-browse-restaurants',\n       '/order-food': 'micro-frontend-order-food',\n       '/user-profile': 'micro-frontend-user-profile',\n     };\n     const webComponentType = webComponentsByRoute[window.location.pathname];\n\n     // Having determined the right web component custom element type,\n     // we now create an instance of it and attach it to the document\n     const root = document.getElementById('micro-frontend-root');\n     const webComponent = document.createElement(webComponentType);\n     root.appendChild(webComponent);\n   <\/script>\n </body>\n</html>\n")),(0,i.kt)("p",null,"the main difference being that you are opting in to doing things 'the web component way'.\nIf you like the web component spec, and you like the idea of using capabilities that the browser provides,\nthen this is a good option. If you prefer to define your own interface between the container\napplication and micro frontends, then you might prefer the previous example instead."),(0,i.kt)("p",null,"\u5982\u679c\u4e0d\u9700\u8981\u8003\u8651IE\u6d4f\u89c8\u5668\uff0c\u4e5f\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u9009\u62e9\u3002"),(0,i.kt)("h2",{id:"4-styling"},"4. Styling"),(0,i.kt)("p",null,"In a micro frontends landscape, many of these problems are exacerbated. For example,\nif one team's micro frontend has a stylesheet that says h2 { color: black; },\nand another one says h2 { color: blue; }, and both these selectors are attached to the same page,\nthen someone is going to be disappointed! This is not a new problem,\nbut it's made worse by the fact that these selectors were written by different teams at different times,\nand the code is probably split across separate repositories, making it more difficult to discover."),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"MFE\u4e3b\u8981\u662f\u89e3\u51b3css\u7684\u6837\u5f0f\u91cd\u540d\u95ee\u9898\uff0c\u76ee\u524d\u7684css\u6709\u591a\u79cd\u5199\u6cd5\u6765\u907f\u514d\u8fd9\u4e2a\u95ee\u9898\uff0c BEM\uff0csass/less, css in js.\n\u6211\u76ee\u524d\u5bf9\u8fd9\u4e2a\u5177\u4f53\u7684\u89e3\u51b3\u65b9\u5f0f\u8fd8\u6709\u5f85\u7406\u89e3\uff0c\u540e\u9762\u6211\u4f1a\u53bb\u5370\u8bc1\u4e00\u4e0b\u3002"))),(0,i.kt)("h2",{id:"5-shared-component-libraries"},"5. Shared component libraries"),(0,i.kt)("p",null,"We mentioned above that visual consistency across micro frontends is important,\nand one approach to this is to develop a library of shared, re-usable UI components.\nIn general we believe that this a good idea, although it is difficult to do well.\nThe main benefits of creating such a library are reduced effort through re-use of code,\nand visual consistency. In addition, your component library can serve as a living styleguide,\nand it can be a great point of collaboration between developers and designers."),(0,i.kt)("p",null,"\u7b80\u5355\u6765\u8bf4\uff0cMFE\u4e5f\u662f\u9700\u8981\u540c\u610f\u89c6\u89c9UI \u6807\u51c6\u7684\uff0c\u8fd9\u8d8b\u52bf\u5c31\u9700\u8981\u4e00\u4e2acomponent ui \u5e93\u6765\u652f\u6301\u3002\u6bd4\u5982mui\uff0cbootstrap\u3002\n\u6216\u8005\u662f\u9879\u76ee\u81ea\u5efa\uff0c\u81ea\u5efa\u7684\u65b9\u5f0f\u53ef\u4ee5\u662f\u4ece\u591a\u4e2a\u5b50\u6a21\u5757\u4e2d\u62bd\u53d6common\u7684\u7ec4\u4ef6\u3002\u800c\u4e0d\u7528day1\u7684\u65f6\u5019\u5c31\u6784\u5efa\u3002\n\u4f46\u662f\u8fd9\u4e2acomponent ui \u5e93\u662f\u9700\u8981\u7684\u3002 "),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"\u6211\u9700\u8981\u5728\u9879\u76ee\u4e2d\u8fdb\u4e00\u6b65\u5370\u8bc1\u4e00\u4e0b\u3002\u6bd4\u5982BRP\u548cNew UI MFE\u7684\u5173\u7cfb"))),(0,i.kt)("h2",{id:"6-cross-application-communication"},"6. Cross-application communication"),(0,i.kt)("p",null,"One of the most common questions regarding micro frontends is ",(0,i.kt)("strong",{parentName:"p"},"how to let them talk to each other"),".\nIn general, we recommend having them communicate as little as possible,\nas it often reintroduces the sort of inappropriate coupling that we're seeking to avoid in the first place."),(0,i.kt)("p",null,"That said, some level of cross-app communication is often needed. "),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Custom events allow micro frontends to communicate indirectly, which is a good way to minimise direct coupling,\nthough it does make it harder to determine and enforce the contract that exists between micro frontends. "),(0,i.kt)("li",{parentName:"ul"},"Alternatively, the React model of passing callbacks and data downwards (in this case downwards from the container\napplication to the micro frontends) is also a good solution that makes the contract more explicit. "),(0,i.kt)("li",{parentName:"ul"},"A third alternative is to use the address bar as a communication mechanism.")),(0,i.kt)("p",null,"Whatever approach we choose, we want our micro frontends to communicate by sending messages or events to each other,\nand avoid having any shared state. "),(0,i.kt)("p",null,"Just like sharing a database across microservices, as soon as we share our data structures and domain models,\nwe create massive amounts of coupling, and it becomes extremely difficult to make changes."),(0,i.kt)("p",null,"\u8fd9\u5757\u6211\u73b0\u5728\u8fd8\u7406\u89e3\u4e0d\u5230\u4f4d\uff0c\u9700\u8981\u8fdb\u884c\u4e00\u4e9bPOC\uff0c\u4e4b\u540e\u4f1a\u53e6\u5916\u8be6\u7ec6\u5199\u4e00\u7bc7blog\u3002"))}h.isMDXComponent=!0}}]);